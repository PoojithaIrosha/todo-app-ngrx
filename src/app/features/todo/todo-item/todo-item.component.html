<div
  class="group flex items-center gap-3 rounded-xl border border-zinc-200 bg-white px-4 py-3 min-h-14 shadow-card
             dark:border-zinc-800 dark:bg-zinc-800"
  [class.opacity-60]="todo.completed"
>
  <input
    type="checkbox"
    [checked]="todo.completed"
    (change)="toggle.emit(todo.id)"
    class="h-4 w-4 rounded border-zinc-300 text-indigo-600 focus:ring-indigo-500"
    aria-label="Toggle completion"
  />

  <div class="flex-1">
    <ng-container *ngIf="!editing; else editTpl">
      <p
        class="text-sm"
        [class.line-through]="todo.completed"
        [class.text-zinc-400]="todo.completed"
      >
        {{ todo.title }}
      </p>
    </ng-container>

    <ng-template #editTpl>
      <input
        #titleInput
        type="text"
        [value]="draftTitle"
        (input)="draftTitle = titleInput.value"
        (keydown.enter)="commitEdit()"
        (keydown.escape)="cancelEdit()"
        (blur)="commitEdit()"
        class="w-full rounded-lg border border-zinc-300 bg-white px-2 py-1 text-sm outline-none
                   focus:ring-2 focus:ring-indigo-500 dark:border-zinc-600 dark:bg-zinc-700"
        autofocus
      />
    </ng-template>
  </div>

  <div class="hidden items-center gap-1 group-hover:flex">
    <button
      class="rounded-lg px-2 py-1 text-xs text-zinc-600 hover:bg-zinc-100 dark:text-zinc-300 dark:hover:bg-zinc-700"
      (click)="startEdit()"
      aria-label="Edit"
    >Edit</button>
    <button
      class="rounded-lg px-2 py-1 text-xs text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20"
      (click)="remove.emit(todo.id)"
      aria-label="Delete"
    >Delete</button>
  </div>
</div>
